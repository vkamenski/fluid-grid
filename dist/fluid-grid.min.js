(function(t,i){var e,n,i,o=t.define;(function(t){function o(t,i){return C.call(t,i)}function r(t,i){var e,n,o,r,s,u,l,f,h,c,a=i&&i.split("/"),p=$.map,d=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(i){for(a=a.slice(0,a.length-1),t=a.concat(t.split("/")),f=0;t.length>f;f+=1)if(c=t[f],"."===c)t.splice(f,1),f-=1;else if(".."===c){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((a||d)&&p){for(e=t.split("/"),f=e.length;f>0;f-=1){if(n=e.slice(0,f).join("/"),a)for(h=a.length;h>0;h-=1)if(o=p[a.slice(0,h).join("/")],o&&(o=o[n])){r=o,s=f;break}if(r)break;!u&&d&&d[n]&&(u=d[n],l=f)}!r&&u&&(r=u,s=l),r&&(e.splice(0,s,r),t=e.join("/"))}return t}function s(i,e){return function(){return p.apply(t,w.call(arguments,0).concat([i,e]))}}function u(t){return function(i){return r(i,t)}}function l(t){return function(i){g[t]=i}}function f(i){if(o(v,i)){var e=v[i];delete v[i],x[i]=!0,a.apply(t,e)}if(!o(g,i)&&!o(x,i))throw Error("No "+i);return g[i]}function h(t){var i,e=t?t.indexOf("!"):-1;return e>-1&&(i=t.substring(0,e),t=t.substring(e+1,t.length)),[i,t]}function c(t){return function(){return $&&$.config&&$.config[t]||{}}}var a,p,d,m,g={},v={},$={},x={},C=Object.prototype.hasOwnProperty,w=[].slice;d=function(t,i){var e,n=h(t),o=n[0];return t=n[1],o&&(o=r(o,i),e=f(o)),o?t=e&&e.normalize?e.normalize(t,u(i)):r(t,i):(t=r(t,i),n=h(t),o=n[0],t=n[1],o&&(e=f(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:e}},m={require:function(t){return s(t)},exports:function(t){var i=g[t];return i!==void 0?i:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},a=function(i,e,n,r){var u,h,c,a,p,$,C=[];if(r=r||i,"function"==typeof n){for(e=!e.length&&n.length?["require","exports","module"]:e,p=0;e.length>p;p+=1)if(a=d(e[p],r),h=a.f,"require"===h)C[p]=m.require(i);else if("exports"===h)C[p]=m.exports(i),$=!0;else if("module"===h)u=C[p]=m.module(i);else if(o(g,h)||o(v,h)||o(x,h))C[p]=f(h);else{if(!a.p)throw Error(i+" missing "+h);a.p.load(a.n,s(r,!0),l(h),{}),C[p]=g[h]}c=n.apply(g[i],C),i&&(u&&u.exports!==t&&u.exports!==g[i]?g[i]=u.exports:c===t&&$||(g[i]=c))}else i&&(g[i]=n)},e=n=p=function(i,e,n,o,r){return"string"==typeof i?m[i]?m[i](e):f(d(i,e).f):(i.splice||($=i,e.splice?(i=e,e=n,n=null):i=t),e=e||function(){},"function"==typeof n&&(n=o,o=r),o?a(t,i,e,n):setTimeout(function(){a(t,i,e,n)},15),p)},p.config=function(t){return $=t,p},i=function(t,i,e){i.splice||(e=i,i=[]),o(g,t)||o(v,t)||(v[t]=[t,i,e])},i.amd={jQuery:!0}})(),i("../vendor/almond",function(){}),i("mixins/options",[],function(){return{options:{},setOptions:function(t){return this.options&&(t=$.extend({},this.options,t)),this.options=t,this},parseOptions:function(t,i){var e=this,n=$(t).data()||{},o=RegExp("^"+i+"([a-zA-Z]+)");return $.each(n,function(t,i){n.hasOwnProperty(t)&&o.test(t)&&(shortName=t.match(o)[1].replace(/[A-Z]/,function(t){return(t||"").toLowerCase()}),e.options[shortName]=i)}),this}}}),i("mixins/element",[],function(){return{$el:null,setElement:function(t){return this.$el=$(t),this},render:function(){return this}}}),i("image-loader",[],function(){var t=[],i=!1,e=function(){var n=t.shift();if(n){i=!0;var o=n.image.data("src");n.image.on("load",function(){n.def.resolve(n.image),e()}).on("error",function(){n.def.reject(n.image),e()}).attr("src",o)}else i=!1},n=function(i){var e=$.Deferred();return t.push({def:e,image:$(i)}),e.promise()};return{load:function(t){var o=n(t);return i||e(),o}}}),i("item",["mixins/options","mixins/element","image-loader"],function(t,i,e){var n=function(t){this.setOptions(t).setElement(this.options.el).parseOptions(this.$el,"fluidGrid")};return $.extend(n.prototype,t,i,{resize:function(t,i){var e=t.width-this.getOffset();if(this.$el.width(Math.floor(e)),i){var n=e*this.getAspectRation();this.$el.height(Math.floor(n))}return this},getOffset:function(){var t=this.$el.outerWidth(!0)-this.$el.width();return t},getAspectRation:function(){return this.options.height/this.options.width},position:function(t){return this.$el.css({top:t.top||0,left:t.left||0}),this},render:function(){var t=this;return this.$el.css("position","absolute"),this.$el.find("img").each(function(i,n){t.$el.addClass("loading"),e.load(n).then(function(){t.$el.removeClass("loading")})}),this}}),n}),i("fluid-grid",["item","mixins/options","mixins/element"],function(t,i,e){var n=function(t){var i=this;this.setOptions(t).setElement(this.options.el).parseOptions(this.$el,"fluidGrid"),this.$el.find(this.options.itemSelector).each(function(t,e){i.addItem(e)}),$(window).resize(function(){i.render()})};return $.extend(n.prototype,i,e,{options:{itemSelector:"> .item",columnMaxWidth:300,columnMinWidth:200,keepAspectRetio:!0},columns:{},items:[],addItem:function(i){var e=new t({el:$(i)});return this.items.push(e),this.$el.append(e.el),this.$el.trigger("item-added.fluid-grid",[e]),this},getColumnsCount:function(){var t=Math.ceil(this.width/(this.options.columnMaxWidth+this.getItemsOffset()));return t>this.items.length&&(t=this.items.length),t},getColumnWidth:function(){var t=this.width/this.getColumnsCount();return t>this.options.columnMaxWidth&&(t=this.options.columnMaxWidth),t},getItemsOffset:function(){var t=0;return this.items[0]&&(t=this.items[0].getOffset()),t},findSmallestColumn:function(){var t=null;return $.each(this.columns,function(i,e){(!t||t.height>e.height)&&(t=e)}),t},findHighestColumn:function(){var t=null;return $.each(this.columns,function(i,e){(!t||t.height<e.height)&&(t=e)}),t},createColumns:function(){this.columns={};for(var t=1;this.getColumnsCount()>=t;t++)this.columns[t]={sort:t,height:0}},render:function(){var t=this;this.width=this.$el.width(),this.$el.css({position:"relative",visibility:"visible"}),this.createColumns(),$.each(this.items,function(i,e){var n=t.findSmallestColumn();e.render().resize({width:t.getColumnWidth()},t.options.keepAspectRetio),e.position({top:n.height,left:(n.sort-1)*t.getColumnWidth()}),n.height+=e.$el.outerHeight(!0)});var i=this.findHighestColumn();return i&&this.$el.height(i.height),this}}),n});var r=n("fluid-grid");"undefined"!=typeof module&&module.exports?module.exports=r:o?function(t){t(function(){return r})}(o):t["fluid-grid"]=r})(this);